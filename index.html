<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Luxury Porter | Premier Vancouver Shuttle & Chauffeur</title>
  <meta name="description" content="The Luxury Porter â€“ airport transfers and chauffeur services in Vancouver." />
  <link rel="stylesheet" href="style.css" />

  <!-- Inline CSS for responsive fleet & preview images -->
  <style>
    .service-icon {
      width: 200px;       
      max-width: 100%;    
      height: auto;       
      display: block;     
      margin: 0 auto 1rem;
    }
  </style>

   <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-analytics.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBjRgQHuQM5KtOafaJuFgSeh8sFOZk8-4E",
      authDomain: "the-luxporter-79d0e.firebaseapp.com",
      projectId: "the-luxporter-79d0e",
      storageBucket: "the-luxporter-79d0e.appspot.com",
      messagingSenderId: "988733228385",
      appId: "1:988733228385:web:0c5f52530d059d19c37120",
      measurementId: "G-8C1WSFXET0"
    };

    const app = initializeApp(firebaseConfig);
    getAnalytics(app);
    window.__DB__ = getFirestore(app);
  </script>

  <!-- Google Maps & Places API -->
  <script
    async
    defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDrER52L1EiBYmyU6wDZ-xK9YK5dhtY8_A&libraries=places&callback=initAutocomplete">
  </script>

  <!-- Open Graph -->
  <meta property="og:title"        content="The Luxury Porter | Vancouver Chauffeur & Transfers" />
  <meta property="og:description"  content="Luxury airport transfers and chauffeur services in Vancouver." />
  <meta property="og:url"          content="https://theluxuryporter.com" />
  <meta property="og:type"         content="website" />
</head>

<body>
  <!-- HEADER -->
  <header class="site-header">
    <div class="container">
      <a href="https://theluxuryporter.com" class="logo">
        <img src="assets/logo.png" alt="The Luxury Porter logo" />
      </a>
      <nav class="nav">
        <a href="#services">Services</a>
        <a href="#fleet">Fleet</a>
        <a href="#booking">Book Now</a>
        <a href="#contact">Contact</a>
      </nav>
      <div class="contact-info">
        <a href="tel:6045059651">604.505.9651</a>
        <a href="mailto:info@theluxuryporter.com">info@theluxuryporter.com</a>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section id="hero" class="hero">
    <div class="container">
      <h1>Ride with Luxury. Travel in Style.</h1>
      <p>Premier airport transfers and chauffeur services in Vancouver.</p>
      <a href="#booking" class="btn btn-primary">Book Your Ride</a>
    </div>
  </section>

  <!-- SERVICES -->
  <section id="services" class="section services">
    <div class="container">
      <h2>Our Services</h2>
      <div class="grid3">
        <div class="card">
          <h3>Airport Transfers</h3>
          <p>On-time pickups and drop-offs at YVR and local heliports.</p>
        </div>
        <div class="card">
          <h3>Corporate Chauffeur</h3>
          <p>Discreet rides for executives and VIPs.</p>
        </div>
        <div class="card">
          <h3>Event Transportation</h3>
          <p>Weddings, conferences, galas â€“ arrive in style.</p>
        </div>
      </div>
    </div>
  </section>

 <!-- FLEET -->
<section id="fleet" class="section fleet">
  <div class="container">
    <h2>Our Fleet</h2>
    <div class="grid3">
      <div class="vehicle">
        <img src="assets/sedan.png" alt="Sedan" class="service-icon" />
        <h3>Sedan</h3>
        <p>Up to 3 passengers, refined comfort.</p>
      </div>
      <div class="vehicle">
        <img src="assets/SUV.png" alt="SUV" class="service-icon" />
        <h3>SUV</h3>
        <p>Up to 6 passengers, spacious luxury.</p>
      </div>
      <div class="vehicle">
        <img src="assets/Van.png" alt="Van" class="service-icon" />
        <h3>Van</h3>
        <p>Up to 10 passengers, ultimate convenience.</p>
      </div>
    </div>
  </div>
</section>

  <section id="booking" class="section booking">
  <div class="container">
    <h2>Book Your Ride</h2>
    <div class="widget">

      <div class="field">
        <label for="pickup">Pickup Location</label>
        <input type="text" id="pickup" placeholder="Start typing address..." />
      </div>
      <div class="field">
        <label for="dropoff">Drop-off Location</label>
        <input type="text" id="dropoff" placeholder="Start typing address..." />
      </div>
      <div class="field">
        <label for="passengers">Number of Passengers</label>
        <input type="number" id="passengers" min="1" value="1" />
      </div>
      <div class="field">
        <label for="bags">Number of Bags</label>
        <input type="number" id="bags" min="0" value="0" />
      </div>
      <div class="field">
        <label for="pickupDate">Pickup Date</label>
        <input type="date" id="pickupDate" />
      </div>
      <div class="field">
        <label for="pickupTime">Pickup Time</label>
        <input type="time" id="pickupTime" />
      </div>
      <div class="field">
        <label for="notes">Additional Notes</label>
        <textarea id="notes" placeholder="Enter any special requests or notes"></textarea>
      </div>

      <!-- New Contact & Flight Fields -->
      <div class="field">
        <label for="flight">Flight Number</label>
        <input type="text" id="flight" placeholder="Your flight number" />
      </div>
      <div class="field">
        <label for="phone">Phone Number</label>
        <input type="tel" id="phone" placeholder="Your phone number" />
      </div>
      <div class="field">
        <label for="email">Email Address</label>
        <input type="email" id="email" placeholder="Your email address" />
      </div>

      <div class="field">
        <label for="distance">Distance (km)</label>
        <input type="number" id="distance" readonly />
      </div>
      <div class="field">
        <label for="time">Estimated Time (mins)</label>
        <input type="number" id="time" readonly />
      </div>

      <div class="field">
        <label for="vehicleType">Vehicle Type</label>
        <select id="vehicleType" onchange="updateVehiclePreview()">
          <option value="sedan">Sedan</option>
          <option value="suv">SUV</option>
          <option value="van">Van</option>
        </select>
      </div>
      <div class="field">
        <label for="vehicleClass">Vehicle Class</label>
        <select id="vehicleClass">
          <option value="economy">Economy</option>
          <option value="business">Business</option>
          <option value="luxury">Luxury</option>
        </select>
      </div>

      <div class="vehicle-preview" id="vehiclePreview"></div>
      <div class="field">
        <strong>Total Price: $<span id="price">0.00</span></strong>
      </div>

      <button onclick="calculateRouteAndPrice()">Submit Booking</button>
      <div id="confirmation" class="success"></div>
    </div>
  </div>
</section>

<script type="module">
  import {
    collection,
    addDoc,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

  const db = window.__DB__;

  window.calculateRouteAndPrice = async function () {
    const pickup    = document.getElementById("pickup").value.trim();
    const dropoff   = document.getElementById("dropoff").value.trim();
    const passengers= +document.getElementById("passengers").value;
    const bags      = +document.getElementById("bags").value;
    const date      = document.getElementById("pickupDate").value;
    const time      = document.getElementById("pickupTime").value;
    const notes     = document.getElementById("notes").value.trim();
    const flight    = document.getElementById("flight").value.trim();   // NEW
    const phone     = document.getElementById("phone").value.trim();    // NEW
    const email     = document.getElementById("email").value.trim();    // NEW
    const type      = document.getElementById("vehicleType").value;
    const cls       = document.getElementById("vehicleClass").value;

    if (!pickup || !dropoff || !date || !time || !flight || !phone || !email) {
      return alert("Please fill in pickup, drop-off, date, time, flight no., phone, and email.");
    }

    directionsService.route(
      {
        origin: pickup,
        destination: dropoff,
        travelMode: "DRIVING"
      },
      async (response, status) => {
        if (status !== "OK") return alert("Could not calculate route.");

        const leg  = response.routes[0].legs[0];
        const km   = leg.distance.value / 1000;
        const mins = leg.duration.value / 60;

        document.getElementById("distance").value = km.toFixed(1);
        document.getElementById("time").value     = mins.toFixed(0);

        let rate = 1;
        if (type === "suv")      rate += 0.5;
        if (type === "van")      rate += 1.0;
        if (cls  === "business") rate += 1.0;
        if (cls  === "luxury")   rate += 2.0;

        const price = (km * 1.5 + mins * 0.5) * rate * 1.2;
        document.getElementById("price").textContent = price.toFixed(2);

        try {
          await addDoc(collection(db, "bookings"), {
            pickup,
            dropoff,
            passengers,
            bags,
            date,
            time,
            notes,
            flightNumber: flight,   // NEW
            phone,                  // NEW
            email,                  // NEW
            distance_km: km.toFixed(1),
            duration_min: mins.toFixed(0),
            vehicleType: type,
            vehicleClass: cls,
            price: price.toFixed(2),
            createdAt: serverTimestamp()
          });

          document.getElementById("confirmation").textContent = "ðŸŽ‰ Booking submitted successfully!";
        } catch (err) {
          document.getElementById("confirmation").textContent = "ðŸš¨ Error: " + err.message;
        }
      }
    );
  };

  window.updateVehiclePreview = function () {
    const type = document.getElementById("vehicleType").value;
    const map = {
      sedan: "assets/sedan.png",
      suv:   "assets/SUV.png",
      van:   "assets/Van.png"
    };
    document.getElementById("vehiclePreview").innerHTML =
      `<img src="${map[type]}" alt="${type} preview" />`;
  };
</script>

  <!-- CONTACT -->
  <section id="contact" class="section contact">
    <div class="container">
      <h2>Get in Touch</h2>
      <p>Phone: <a href="tel:6045059651">604.505.9651</a></p>
      <p>Email: <a href="mailto:info@theluxuryporter.com">info@theluxuryporter.com</a></p>
      <p>Web: <a href="https://theluxuryporter.com">theluxuryporter.com</a></p>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="container">
      <p>&copy; 2025 The Luxury Porter. All rights reserved.</p>
    </div>
  </footer>

  <!-- WIDGET SCRIPT -->
  <script>
    let directionsService;

    function initAutocomplete() {
      directionsService = new google.maps.DirectionsService();
      new google.maps.places.Autocomplete(
        document.getElementById("pickup")
      );
      new google.maps.places.Autocomplete(
        document.getElementById("dropoff")
      );
    }

    function calculateRouteAndPrice() {
      const pickup    = document.getElementById("pickup").value;
      const dropoff   = document.getElementById("dropoff").value;
      const passengers= +document.getElementById("passengers").value;
      const bags      = +document.getElementById("bags").value;
      const date      = document.getElementById("pickupDate").value;
      const time      = document.getElementById("pickupTime").value;
      const notes     = document.getElementById("notes").value;
      const type      = document.getElementById("vehicleType").value;
      const cls       = document.getElementById("vehicleClass").value;

      if (!pickup || !dropoff || !date || !time) {
        alert("Please fill in pickup, drop-off, date, and time.");
        return;
      }

      directionsService.route(
        {
          origin: pickup,
          destination: dropoff,
          travelMode: "DRIVING",
        },
        (response, status) => {
          if (status === "OK") {
            const leg  = response.routes[0].legs[0];
            const km   = leg.distance.value  / 1000;
            const mins = leg.duration.value  / 60;
            document.getElementById("distance").value = km.toFixed(1);
            document.getElementById("time"    ).value = mins.toFixed(0);

            let rate = 1.0;
            if (type === "suv") rate += 0.5;
            if (type === "van") rate += 1.0;
            if (cls  === "business") rate += 1.0;
            if (cls  === "luxury") rate += 2.0;

            const basePrice  = km * 1.5 + mins * 0.5;
            const finalPrice = basePrice * rate * 1.2;
            document.getElementById("price").textContent = finalPrice.toFixed(2);

            // Save booking in Firestore
            db.collection("bookings")
              .add({
                pickup,
                dropoff,
                passengers,
                bags,
                date,
                time,
                notes,
                distance_km: km.toFixed(1),
                duration_min: mins.toFixed(0),
                vehicleType: type,
                vehicleClass: cls,
                price: finalPrice.toFixed(2),
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
              })
              .then(() => {
                document.getElementById("confirmation").textContent =
                  "Booking submitted successfully!";
              })
              .catch((err) => {
                document.getElementById("confirmation").textContent =
                  "Error saving booking: " + err.message;
              });
          } else {
            alert("Could not calculate route. Please try again.");
          }
        }
      );
    }

    function updateVehiclePreview() {
      const type = document.getElementById("vehicleType").value;
      const map = {
        sedan: "assets/sedan.png",
        suv:   "assets/suv.png",
        van:   "assets/van.png"
      };

      document.getElementById("vehiclePreview").innerHTML = `
        <img src="${map[type]}" alt="${type} preview" class="service-icon" />
      `;
    }
  </script>
</body>
</html>
